<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 9.6.12 (471320)"/><meta name="altitude" content="35.75897598266602"/><meta name="author" content="uq2bca3m"/><meta name="created" content="2023-06-07 15:22:04 +0000"/><meta name="latitude" content="39.99005126953125"/><meta name="longitude" content="116.5069477933831"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2023-06-07 15:23:25 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>380. O(1) 时间插入、删除和获取随机元素</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">实现RandomizedSet 类：</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">RandomizedSet() 初始化 RandomizedSet 对象<br/>
bool insert(int val) 当元素 val 不存在时，向集合中插入该项，并返回 true ；否则，返回 false 。<br/>
bool remove(int val) 当元素 val 存在时，从集合中移除该项，并返回 true ；否则，返回 false 。<br/>
int getRandom() 随机返回现有集合中的一项（测试用例保证调用此方法时集合中至少存在一个元素）。每个元素应该有 相同的概率 被返回。<br/>
你必须实现类的所有函数，并满足每个函数的 平均 时间复杂度为 O(1) 。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;"/>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">示例：</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">输入</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">["RandomizedSet", "insert", "remove", "insert", "getRandom", "remove", "insert", "getRandom"]</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">[[], [1], [2], [2], [], [1], [2], []]<br/>
输出</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">[null, true, false, true, 2, true, false, 2]</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">解释<br/>
RandomizedSet randomizedSet = new RandomizedSet();<br/>
randomizedSet.insert(1); // 向集合中插入 1 。返回 true 表示 1 被成功地插入。<br/>
randomizedSet.remove(2); // 返回 false ，表示集合中不存在 2 。<br/>
randomizedSet.insert(2); // 向集合中插入 2 。返回 true 。集合现在包含 [1,2] 。<br/>
randomizedSet.getRandom(); // getRandom 应随机返回 1 或 2 。<br/>
randomizedSet.remove(1); // 从集合中移除 1 ，返回 true 。集合现在包含 [2] 。<br/>
randomizedSet.insert(2); // 2 已在集合中，所以返回 false 。<br/>
randomizedSet.getRandom(); // 由于 2 是集合中唯一的数字，getRandom 总是返回 2 。</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">提示：</p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">-231 &lt;= val &lt;= 231 - 1<br/>
最多调用 insert、remove 和 getRandom 函数 2 *&nbsp;&nbsp;105 次<br/>
在调用 getRandom 方法时，数据结构中 至少存在一个 元素。</p>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">class</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">RandomizedSet</span>:</span>

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">__init__</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self)</span>:</span>
        self.lst = []

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">insert</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self, val: int)</span> -&gt; bool:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span> val <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">not</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">in</span> self.lst:
            self.lst.append(val)
            <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">True</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">False</span>

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">remove</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self, val: int)</span> -&gt; bool:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span> val <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">in</span> self.lst:
            self.lst.remove(val)
            <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">True</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">False</span>

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">getRandom</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self)</span> -&gt; int:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> choice(self.lst)


<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;"># Your RandomizedSet object will be instantiated and called as such:</span>
<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;"># obj = RandomizedSet()</span>
<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;"># param_1 = obj.insert(val)</span>
<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;"># param_2 = obj.remove(val)</span>
<span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;"># param_3 = obj.getRandom()</span>
</code></pre>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">class</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">RandomizedSet</span>:</span>
    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">__init__</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self)</span>:</span>
        self.nums = []
        self.indices = {}

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">insert</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self, val: int)</span> -&gt; bool:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span> val <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">in</span> self.indices:
            <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">False</span>
        self.indices[val] = len(self.nums)
        self.nums.append(val)
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">True</span>

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">remove</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self, val: int)</span> -&gt; bool:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span> val <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">not</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">in</span> self.indices:
            <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">False</span>
        id = self.indices[val]
        self.nums[id] = self.nums[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]
        self.indices[self.nums[id]] = id
        self.nums.pop()
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">del</span> self.indices[val]
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">True</span>

    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">def</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">getRandom</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(self)</span> -&gt; int:</span>
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">return</span> choice(self.nums)
</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%E5%AE%9E%E7%8E%B0RandomizedSet%20%E7%B1%BB%EF%BC%9A%0A%0ARandomizedSet()%20%E5%88%9D%E5%A7%8B%E5%8C%96%20RandomizedSet%20%E5%AF%B9%E8%B1%A1%0Abool%20insert(int%20val)%20%E5%BD%93%E5%85%83%E7%B4%A0%20val%20%E4%B8%8D%E5%AD%98%E5%9C%A8%E6%97%B6%EF%BC%8C%E5%90%91%E9%9B%86%E5%90%88%E4%B8%AD%E6%8F%92%E5%85%A5%E8%AF%A5%E9%A1%B9%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%20true%20%EF%BC%9B%E5%90%A6%E5%88%99%EF%BC%8C%E8%BF%94%E5%9B%9E%20false%20%E3%80%82%0Abool%20remove(int%20val)%20%E5%BD%93%E5%85%83%E7%B4%A0%20val%20%E5%AD%98%E5%9C%A8%E6%97%B6%EF%BC%8C%E4%BB%8E%E9%9B%86%E5%90%88%E4%B8%AD%E7%A7%BB%E9%99%A4%E8%AF%A5%E9%A1%B9%EF%BC%8C%E5%B9%B6%E8%BF%94%E5%9B%9E%20true%20%EF%BC%9B%E5%90%A6%E5%88%99%EF%BC%8C%E8%BF%94%E5%9B%9E%20false%20%E3%80%82%0Aint%20getRandom()%20%E9%9A%8F%E6%9C%BA%E8%BF%94%E5%9B%9E%E7%8E%B0%E6%9C%89%E9%9B%86%E5%90%88%E4%B8%AD%E7%9A%84%E4%B8%80%E9%A1%B9%EF%BC%88%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E4%BF%9D%E8%AF%81%E8%B0%83%E7%94%A8%E6%AD%A4%E6%96%B9%E6%B3%95%E6%97%B6%E9%9B%86%E5%90%88%E4%B8%AD%E8%87%B3%E5%B0%91%E5%AD%98%E5%9C%A8%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%EF%BC%89%E3%80%82%E6%AF%8F%E4%B8%AA%E5%85%83%E7%B4%A0%E5%BA%94%E8%AF%A5%E6%9C%89%20%E7%9B%B8%E5%90%8C%E7%9A%84%E6%A6%82%E7%8E%87%20%E8%A2%AB%E8%BF%94%E5%9B%9E%E3%80%82%0A%E4%BD%A0%E5%BF%85%E9%A1%BB%E5%AE%9E%E7%8E%B0%E7%B1%BB%E7%9A%84%E6%89%80%E6%9C%89%E5%87%BD%E6%95%B0%EF%BC%8C%E5%B9%B6%E6%BB%A1%E8%B6%B3%E6%AF%8F%E4%B8%AA%E5%87%BD%E6%95%B0%E7%9A%84%20%E5%B9%B3%E5%9D%87%20%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E4%B8%BA%20O(1)%20%E3%80%82%0A%0A%C2%A0%0A%0A%E7%A4%BA%E4%BE%8B%EF%BC%9A%0A%0A%E8%BE%93%E5%85%A5%0A%5B%22RandomizedSet%22%2C%20%22insert%22%2C%20%22remove%22%2C%20%22insert%22%2C%20%22getRandom%22%2C%20%22remove%22%2C%20%22insert%22%2C%20%22getRandom%22%5D%0A%5B%5B%5D%2C%20%5B1%5D%2C%20%5B2%5D%2C%20%5B2%5D%2C%20%5B%5D%2C%20%5B1%5D%2C%20%5B2%5D%2C%20%5B%5D%5D%0A%E8%BE%93%E5%87%BA%0A%5Bnull%2C%20true%2C%20false%2C%20true%2C%202%2C%20true%2C%20false%2C%202%5D%0A%0A%E8%A7%A3%E9%87%8A%0ARandomizedSet%20randomizedSet%20%3D%20new%20RandomizedSet()%3B%0ArandomizedSet.insert(1)%3B%20%2F%2F%20%E5%90%91%E9%9B%86%E5%90%88%E4%B8%AD%E6%8F%92%E5%85%A5%201%20%E3%80%82%E8%BF%94%E5%9B%9E%20true%20%E8%A1%A8%E7%A4%BA%201%20%E8%A2%AB%E6%88%90%E5%8A%9F%E5%9C%B0%E6%8F%92%E5%85%A5%E3%80%82%0ArandomizedSet.remove(2)%3B%20%2F%2F%20%E8%BF%94%E5%9B%9E%20false%20%EF%BC%8C%E8%A1%A8%E7%A4%BA%E9%9B%86%E5%90%88%E4%B8%AD%E4%B8%8D%E5%AD%98%E5%9C%A8%202%20%E3%80%82%0ArandomizedSet.insert(2)%3B%20%2F%2F%20%E5%90%91%E9%9B%86%E5%90%88%E4%B8%AD%E6%8F%92%E5%85%A5%202%20%E3%80%82%E8%BF%94%E5%9B%9E%20true%20%E3%80%82%E9%9B%86%E5%90%88%E7%8E%B0%E5%9C%A8%E5%8C%85%E5%90%AB%20%5B1%2C2%5D%20%E3%80%82%0ArandomizedSet.getRandom()%3B%20%2F%2F%20getRandom%20%E5%BA%94%E9%9A%8F%E6%9C%BA%E8%BF%94%E5%9B%9E%201%20%E6%88%96%202%20%E3%80%82%0ArandomizedSet.remove(1)%3B%20%2F%2F%20%E4%BB%8E%E9%9B%86%E5%90%88%E4%B8%AD%E7%A7%BB%E9%99%A4%201%20%EF%BC%8C%E8%BF%94%E5%9B%9E%20true%20%E3%80%82%E9%9B%86%E5%90%88%E7%8E%B0%E5%9C%A8%E5%8C%85%E5%90%AB%20%5B2%5D%20%E3%80%82%0ArandomizedSet.insert(2)%3B%20%2F%2F%202%20%E5%B7%B2%E5%9C%A8%E9%9B%86%E5%90%88%E4%B8%AD%EF%BC%8C%E6%89%80%E4%BB%A5%E8%BF%94%E5%9B%9E%20false%20%E3%80%82%0ArandomizedSet.getRandom()%3B%20%2F%2F%20%E7%94%B1%E4%BA%8E%202%20%E6%98%AF%E9%9B%86%E5%90%88%E4%B8%AD%E5%94%AF%E4%B8%80%E7%9A%84%E6%95%B0%E5%AD%97%EF%BC%8CgetRandom%20%E6%80%BB%E6%98%AF%E8%BF%94%E5%9B%9E%202%20%E3%80%82%0A%C2%A0%0A%0A%E6%8F%90%E7%A4%BA%EF%BC%9A%0A%0A-231%20%3C%3D%20val%20%3C%3D%20231%20-%201%0A%E6%9C%80%E5%A4%9A%E8%B0%83%E7%94%A8%20insert%E3%80%81remove%20%E5%92%8C%20getRandom%20%E5%87%BD%E6%95%B0%202%20*%C2%A0105%20%E6%AC%A1%0A%E5%9C%A8%E8%B0%83%E7%94%A8%20getRandom%20%E6%96%B9%E6%B3%95%E6%97%B6%EF%BC%8C%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%AD%20%E8%87%B3%E5%B0%91%E5%AD%98%E5%9C%A8%E4%B8%80%E4%B8%AA%20%E5%85%83%E7%B4%A0%E3%80%82%0A%0A%0A%60%60%60python%0Aclass%20RandomizedSet%3A%0A%0A%20%20%20%20def%20__init__(self)%3A%0A%20%20%20%20%20%20%20%20self.lst%20%3D%20%5B%5D%0A%0A%20%20%20%20def%20insert(self%2C%20val%3A%20int)%20-%3E%20bool%3A%0A%20%20%20%20%20%20%20%20if%20val%20not%20in%20self.lst%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.lst.append(val)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20def%20remove(self%2C%20val%3A%20int)%20-%3E%20bool%3A%0A%20%20%20%20%20%20%20%20if%20val%20in%20self.lst%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20self.lst.remove(val)%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20True%0A%20%20%20%20%20%20%20%20return%20False%0A%0A%20%20%20%20def%20getRandom(self)%20-%3E%20int%3A%0A%20%20%20%20%20%20%20%20return%20choice(self.lst)%0A%0A%0A%23%20Your%20RandomizedSet%20object%20will%20be%20instantiated%20and%20called%20as%20such%3A%0A%23%20obj%20%3D%20RandomizedSet()%0A%23%20param_1%20%3D%20obj.insert(val)%0A%23%20param_2%20%3D%20obj.remove(val)%0A%23%20param_3%20%3D%20obj.getRandom()%0A%60%60%60%0A%0A%0A%60%60%60python%0Aclass%20RandomizedSet%3A%0A%20%20%20%20def%20__init__(self)%3A%0A%20%20%20%20%20%20%20%20self.nums%20%3D%20%5B%5D%0A%20%20%20%20%20%20%20%20self.indices%20%3D%20%7B%7D%0A%0A%20%20%20%20def%20insert(self%2C%20val%3A%20int)%20-%3E%20bool%3A%0A%20%20%20%20%20%20%20%20if%20val%20in%20self.indices%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20self.indices%5Bval%5D%20%3D%20len(self.nums)%0A%20%20%20%20%20%20%20%20self.nums.append(val)%0A%20%20%20%20%20%20%20%20return%20True%0A%0A%20%20%20%20def%20remove(self%2C%20val%3A%20int)%20-%3E%20bool%3A%0A%20%20%20%20%20%20%20%20if%20val%20not%20in%20self.indices%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20False%0A%20%20%20%20%20%20%20%20id%20%3D%20self.indices%5Bval%5D%0A%20%20%20%20%20%20%20%20self.nums%5Bid%5D%20%3D%20self.nums%5B-1%5D%0A%20%20%20%20%20%20%20%20self.indices%5Bself.nums%5Bid%5D%5D%20%3D%20id%0A%20%20%20%20%20%20%20%20self.nums.pop()%0A%20%20%20%20%20%20%20%20del%20self.indices%5Bval%5D%0A%20%20%20%20%20%20%20%20return%20True%0A%0A%20%20%20%20def%20getRandom(self)%20-%3E%20int%3A%0A%20%20%20%20%20%20%20%20return%20choice(self.nums)%0A%60%60%60</center></body></html>